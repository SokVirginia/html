const swiper = new Swiper('.swiper', {
    slidesPerView: "auto",
    spaceBetween: 10,
    scrollbar: {
        el: '.swiper-scrollbar',
    },
});


$(".filter-select select").niceSelect()


$("._tab").click(function () {
    let parentBlock = $(this).parents("._tabs-parent")
    let tabId = $(this).attr("data-tab")
    console.log(parentBlock)
    $(parentBlock).find("._tab").removeClass("_active")
    $(this).addClass("_active")
    $(parentBlock).find(".tab-content").fadeOut(300)
    $(parentBlock).find(`._${tabId}`).fadeIn(300)
})

$(".favourite-btn").click(function () {
    $(this).toggleClass("_added")
})

setBg()

function setBg() {
    $("._response-bg").each(function (i, el) {
        if (window.innerWidth > 992) {
            setStyle($(el), $(el).attr("data-desktop-bg"))
        } else if (window.innerWidth > 576 && window.innerWidth <= 992) {
            setStyle($(el), $(el).attr("data-tablet-bg"))
        } else {
            setStyle($(el), $(el).attr("data-mob-bg"))
        }
    })

    function setStyle(el, imgSrc) {
        $(el).css("background-image", `url(${imgSrc})`)
    }
}

$(".rating-input__item").click(function () {
    let ratingItem = parseInt($(this).attr("data-rating-value"))
    $(this).parent(".rating-input").attr("data-total-rating", ratingItem)
    $(this).siblings(".rating-input__field").val(ratingItem)
})

// $(".rating-input__item").mouseover(function() {
//     let ratingItem = parseInt($(this).attr("data-rating-value"))
//     $(this).parent(".rating-input").attr("data-total-rating", ratingItem)
//     $(this).siblings(".rating-input__field").val(ratingItem)
// })

// header scripts

$("._search-field").on("input", function () {
    let val = $(this).val()
    if (val.length > 3) {
        $(".header-search").addClass("_filled")
    } else {
        $(".header-search").removeClass("_filled")
    }
})

$("._show-search").click(function () {
    $(".header-search").addClass("_active")
})

$(".header-search__close").click(function () {
    $(".header-search").removeClass("_active")
    $(".header-search").removeClass("_filled")
})


$(document).mouseup(function (e) {
    var div = $('.header-search');
    if (!div.is(e.target) && div.has(e.target).length === 0) {
        if ($(div).hasClass("_filled")) {
            $(div).removeClass("_filled")
        }
    }
});

$(document).mouseup(function (e) {
    var div = $('.catalog-menu');
    if (!div.is(e.target) && div.has(e.target).length === 0) {
        if ($(".header").hasClass("_show-catalog")) {
            $(".header").removeClass("_show-catalog")
        }
    }
});

$(".header__catalog-btn").click(function () {
    $(".header").toggleClass("_show-catalog")
})

$(".burger").click(function () {
    $(".header").addClass("_open")
    $("body").addClass("fixed-body")
})

$("._close-menu").click(function () {
    $(".header").removeClass("_open")
    $(".nav__item").removeClass("_open")
    $(".submenu__item").removeClass("_open")
    $(".submenu").removeClass("_fixed")
    $("body").removeClass("fixed-body")
})

$("._show-cart").click(function (e) {
    if (window.innerWidth > 992) {
        e.preventDefault()
        $(".mini-cart").addClass("_active")
        $(this).addClass("_active")
    }
})

$(document).mouseup(function (e) {
    var div = $('.mini-cart');
    if (!div.is(e.target) && div.has(e.target).length === 0) {
        if ($(div).hasClass("_active")) {
            $(div).removeClass("_active")
            $("._show-cart").removeClass("_active")
        }
    }
});

$(window).scroll(function () {
    setFixHeader()
});


setFixHeader()


function setFixHeader() {
    var st = $(this).scrollTop();
    if (st > 200) {
        $(".header").addClass("_transform")
    }
    if (st > 250) {
        $(".header").addClass("_fixed-header")
        // $(".header").removeClass("_transform")
    } else {
        $(".header").removeClass("_fixed-header")
        $(".header").removeClass("_transform")
    }
}

$(".nav__item-show").click(function () {
    $(this).parents(".nav__item").addClass("_open")
    $(".menu").addClass("_fixed")
})

$(".nav__item > .submenu > .submenu__top >._close-submenu").click(function () {
    $(".nav__item").removeClass("_open")
    $(".menu").removeClass("_fixed")
})

$(".submenu__item-show").click(function () {
    console.log(true)
    $(this).parent(".submenu__item").addClass("_open")
    $(this).parent(".submenu__item").parent(".submenu__links").parent(".submenu").addClass("_fixed")
})

$(".submenu__item > .submenu > .submenu__top >._close-submenu").click(function () {
    $(this).parent(".submenu__top").parent(".submenu").parent(".submenu__item").removeClass("_open")
    $(this).closest(".submenu__links").closest(".submenu").removeClass("_fixed")
})


document.querySelector('.header__call-inner')
    .onclick = function () {
        if (this.classList.contains('checked')) {
            this.classList.remove('checked')
        }
        else { this.classList.add('checked') }
    }
$(document).mouseup(function (e) {
    var container = $('.header__call-inner.checked'); // Указываем у какого блока / класса убираем
    if (container.has(e.target).length === 0) {
        container.removeClass('checked');            // Какой класс убираем
    }
});

// footer scripts
$(".footer__toggle").click(function () {
    if (window.innerWidth <= 576) {
        $(this).toggleClass("_active")
        $(this).siblings(".footer__dropdown").slideToggle()
    }
})


// end footer scripts

// sliders
function mainSlider() {
    var swiper = new Swiper('.main .swiper-container', {
        slidesPerView: 1,
        spaceBetween: 10,
        loop: true,
        navigation: {
            nextEl: '.main .swiper-button-next',
            prevEl: '.main .swiper-button-prev',
        },
        pagination: {
            el: '.main .swiper-pagination',
            type: 'bullets',
            clickable: true,
        },
    })
}

function brandsSlider() {
    var swiper = new Swiper('.brands .swiper-container', {
        slidesPerView: 'auto',
        spaceBetween: 0,
        navigation: {
            nextEl: '.brands .swiper-button-next',
            prevEl: '.brands .swiper-button-prev',
        },
        scrollbar: {
            el: '.brands .swiper-scrollbar',
            draggable: true,
        },
        breakpoints: {
            320: {
                slidesPerView: 1.7,
            },
            576: {
                slidesPerView: 'auto',
            }
        }
    })
}

function servicesSlider() {
    var swiper = new Swiper('.related-service .swiper-container', {
        slidesPerView: "auto",
        spaceBetween: 0,
        scrollbar: {
            el: '.related-service .swiper-scrollbar',
            draggable: true,
        },
    })
}

function historySlider() {
    var swiper = new Swiper('.history .swiper-container', {
        slidesPerView: "auto",
        spaceBetween: 0,
        scrollbar: {
            el: '.history .swiper-scrollbar',
            draggable: true,
        },
    })
}

function tariffsSlider() {
    var swiper = new Swiper('.tariffs .swiper-container', {
        slidesPerView: "auto",
        spaceBetween: 0,
        scrollbar: {
            el: '.tariffs .swiper-scrollbar',
            draggable: true,
        },
    })
}



function Sliders() {
    let SlidersArray = []
    $(".mob-slider").each(function (index, el) {
        $(el).attr("data-slider-id", `${index}`)
        SlidersArray[index] = new Swiper(`.mob-slider[data-slider-id="${index}"] .swiper-container`, {
            slidesPerView: "auto",
            spaceBetween: 0,
            observer: true,
            observeParents: true,
            observeSlideChildren: true,
            scrollbar: {
                el: `.mob-slider[data-slider-id="${index}"] .swiper-scrollbar`,
                draggable: true,
            },
        })
    })
}


mainSlider()
brandsSlider()
servicesSlider()
historySlider()
// collectionSlider()
tariffsSlider()
Sliders()
// end sliders

function cartCalc() {
    $('.cartcalc .ccalc-minus').click(function () {
        let a = $(this).closest('.cartcalc').find('input').val();
        if (a > 1) {
            let b = +a - 1;
            $(this).closest('.cartcalc').find('input').val(b);
            $(this).attr("data-val", b)
        } else {
            $(this).attr("data-val", 0)
            $(this).closest('.cartcalc').find('input').val(a);
        }
    });
    $('.cartcalc .ccalc-plus').click(function () {
        let a = $(this).closest('.cartcalc').find('input').val();
        let b = +a + 1;
        $(this).closest('.cartcalc').find('input').val(b);
    });
}

cartCalc()

$(".product-text__toggle").click(function () {
    $(this).parents(".product-text").toggleClass("_active")
})

$(".feedback-nav__btn").click(function () {
    $(".feedback__add-new").slideToggle()
})

$(".feedback-files__btn").click(function () {
    let fileInputHtml = `
    <div class="file-input">
        <input type="file">
        <img src="img/file.svg" alt="">
        <span class="text16">Прикрепить изображение (не более 1 мб)</span>
    </div>
    `
    $(".feedback-files__fields").append(fileInputHtml)
})


$(".catalog-nav__show").click(function () {
    $(this).parents(".catalog-nav__item").toggleClass("_active")
    $(this).siblings(".catalog-nav__hidden").slideToggle()
})


$(".filter-select__check input").change(function () {
    let checkedInputCount = $(this).parents(".filter-select").find(".m-check input:checked").length
    console.log(checkedInputCount)
    if (checkedInputCount > 0) {
        $(this).parents(".filter-select").find(".count").html(checkedInputCount)
    } else {
        $(this).parents(".filter-select").find(".count").html('')
    }
})

if (window.innerWidth > 576) {
    $(".filter-select__field").click(function () {
        $(this).parents(".filter-select").addClass("_active")
    })

    $(document).mouseup(function (e) {
        var div = $('.filter-select__dropdown');
        if (!div.is(e.target) && div.has(e.target).length === 0) {
            if ($(div).parents(".filter-select").hasClass("_active")) {
                $(div).parents(".filter-select").removeClass("_active")
            }
        }
    });
} else {
    $(".filter-select__field").click(function () {
        $(this).parents(".filter-select").toggleClass("_active")
        $(this).parents(".filter-select").toggleClass("_mob-select")
        $(this).siblings(".filter-select__dropdown").slideToggle()
    })
}

$(".catalog-list__toggle-filter").click(function () {
    $(".filter").addClass("_active")
    $("body").addClass("fixed-body")
})

$(".filter__close").click(function () {
    $(".filter").removeClass("_active")
    $("body").removeClass("fixed-body")
})


$(".views-tab__btn").click(function () {
    let tab = $(this).attr("data-view")
    console.log(tab)
    $(".views-tab__btn").removeClass("_active")
    $(this).addClass("_active")
    $(".catalog-list__view").removeClass("_active")
    $(`.catalog-list__view[data-view="${tab}"]`).addClass("_active")
})

$("._show-calc").click(function () {
    $(this).parents(".catalog-card__nav").addClass("_active")

    $(".ccalc-minus").click(function () {
        let val = $(this).attr("data-val")
        if (+val < 1) {
            $(this).parents(".catalog-card__nav").removeClass("_active")
        }
    })
})

$(".qa-card__show").click(function () {
    $(this).parents(".qa-card").toggleClass("_active")
    $(this).siblings(".qa-card__hidden").slideToggle()
})

$("[data-modal]").click(function () {
    let modalId = $(this).attr("data-modal")

    openModal(modalId)
})

function openModal(modalId) {
    closeModal()
    $(`#${modalId}`).addClass("modal--active")
    $("body").addClass("fixed-body")
}


$("._close-modal").click(function () {
    closeModal()
})

function closeModal() {
    if (!$(".header").hasClass("_open")) {
        $("body").removeClass("fixed-body")
    }
    $('.modal').removeClass("modal--active")
}

$("._show-product").click(function () {
    $(".product-modal").addClass("product-modal--active")
    $("body").addClass("fixed-body")
})

$(".product-modal__bg").click(function () {
    $(".product-modal").removeClass("product-modal--active")
    $("body").removeClass("fixed-body")
})

$("._show-detail-order").click(function () {
    $(this).toggleClass("_active")
    $(".user-info").slideToggle()
})

$("._show-pay-options").click(function () {
    $(this).toggleClass("_active")
    $(".pay-options").slideToggle()
})

$("._show-shipment").click(function () {
    $(this).toggleClass("_active")
    $(".shipment").slideToggle()
})

$(document).ready(function () {
    $('input[type="tel"]').mask('+7 999 999-9999', { autoclear: false }, { placeholder: '+7             ' }); 7

    fix100vh();
    window.addEventListener('resize', () => {
        fix100vh();
    })
});

function fix100vh() {
    let vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', `${vh}px`);
}

//# sourceMappingURL=../sourcemaps/main.min.js.map


//tabs_2

const tabsBTn = document.querySelectorAll('.comparsion__link');
const tabsItems = document.querySelectorAll('.tabs-item');

tabsBTn.forEach(function (item) {
    item.addEventListener("click", function () {
        let currentBtn = item;
        let tabId = currentBtn.getAttribute('data-tab');
        let currentTab = document.querySelector(tabId);

        tabsBTn.forEach(function (item) {
            item.classList.remove('active');
        });
        tabsItems.forEach(function (item) {
            item.classList.remove('active');
        });

        currentBtn.classList.add('active');
        currentTab.classList.add('active');

    });
});

//tabs_2